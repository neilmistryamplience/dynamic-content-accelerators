'use strict';

(function (exports) {

  function initSFCCContentSearch() {
    var testContentSearch = {"_v":"20.4","_type":"content_search_result","count":1,"hits":[{"_type":"content","id":"ways-to-wear-the-oversized-shirt","name":"SFCC - Blog Content Asset - The Oversized Shirt","c_body":"<!-- end old HBS -->\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- SFCC Slots -->\n\n<!-- end old HBS -->\n\n\n\n\n\n\n\n\n\n\n\n\n<div class=\"amp-dc-blog js_dc_blog\">\n        <div class=\"amp-dc-snippet js_dc_snippet\">\n   <div class=\"amp-dc-image-pic-wrap\">\n    <picture class=\"amp-dc-image \">\n                <source media=\"(max-width: 640px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1.webp?w=640&qlt=75\" type=\"image/webp\">\n                <source media=\"(max-width: 768px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1.webp?w=1024&qlt=75\" type=\"image/webp\">\n                <source media=\"(min-width: 768px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1.webp?w=1440&qlt=75\" type=\"image/webp\">\n                <source media=\"(min-width: 1024px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1.webp?w=2000&qlt=75\" type=\"image/webp\">\n\n                <source media=\"(max-width: 640px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1?w=640&qlt=75\" type=\"image/jpeg\">\n                <source media=\"(max-width: 768px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1?w=1024&qlt=75\" type=\"image/jpeg\">\n                <source media=\"(min-width: 768px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1?w=1440&qlt=75\" type=\"image/jpeg\">\n                <source media=\"(min-width: 1024px)\" srcset=\"//i1.adis.ws/i/dem/Oversized-shirt1?w=2000&qlt=75\" type=\"image/jpeg\">\n                <img loading=\"lazy\" class=\"amp-dc-image-pic\" src=\"//i1.adis.ws/i/dem/Oversized-shirt1\" alt=\"The Oversized Shirt\">\n        <div class=\"overlay\"></div>\n    </picture>\n</div> \n  <div class=\"amp-dc-snippet-overlay\">\n      <h1 class=\"o-dc-text-headline1    \"  >Ways To Wear: The Oversized Shirt</h1>      <p class=\"o-dc-text-copy    \"  >Ways To Wear: The Oversized Shirt</p>     \n  <div class=\"amp-dc-link\">\n    <span class=\"amp-dc-snippet-more\" href=\"https://thefix.boohoo.com/story/ways-to-wear-the-oversized-shirt\">\n       Read more \n    </span>\n  </div>\n   \n</div>\n</div>\n    <div class=\"amp-dc-blog-content\">\n        <div class=\"amp-dc-block-wrap\">\n            <div class=\"amp-dc-text\" >\n\t\t<p>If you don’t already own an oversized shirt then babes, hop to! An oversized shirt is the perfect wardrobe staple – wear it with pants, without pants, tuck it in, tie it up. There’s a million and one ways to style an oversized shirt and here’s just a a few ideas!</p>\n<p><strong><a href=\"https://www.boohoo.com/search?q=oversized+shirt\">Shop oversized shirts</a></strong></p>\n<hr>\n<ol>\n<li><strong>THE CORSET</strong></li>\n</ol>\n\n\t</div>\t\n\t\n<picture class=\"amp-dc-image\">\n\t\t\t<img loading=\"lazy\" src=\"//i1.adis.ws/i/dem/071219_NEW-SEASON_ZM_Shot_24_1019?upscale=false&strip=true\" class=\"amp-dc-image-pic\"/>\n\t\t</picture><div class=\"amp-dc-text\" >\n\t\t<p>Corsets are one trend going absolutely nowhere, so invest in one to add to your oversized shirt look. It’s the perfect look for brunch with the girls that may end in an all day prosecco sesh! A corset will help nip in your waist to, to give you curves in all the right places! Team with simple jewellery and either barely there’s or a mule.</p>\n<p><strong><a href=\"https://www.boohoo.com/search?q=corset+top\">Shop corsets</a></strong></p>\n<hr>\n<p><strong>2. THE CYCLING SHORTS</strong></p>\n\n\t</div>\t\n\t\n<picture class=\"amp-dc-image\">\n\t\t\t<img loading=\"lazy\" src=\"//i1.adis.ws/i/dem/071219_NEW-SEASON_ZM_Shot_22_0910?upscale=false&strip=true\" class=\"amp-dc-image-pic\"/>\n\t\t</picture><div class=\"amp-dc-text\" >\n\t\t<p>If you’re looking for a go-to daytime look then look no further than an oversized shirt.  Team with a pair of trusty cycling shorts, chunky boots and this season’s must-have bag, a micro shoulder bag! Add a red lip to add a pop of colour and you’re done!</p>\n<p>Look casual, cool and comfy all in a few easy steps.  This is definitely an Instagram worthy outfit!</p>\n<p><strong><a href=\"https://www.boohoo.com/womens/shorts/cycling-shorts\">Shop cycling shorts</a></strong></p>\n<hr>\n<p><strong>3. THE DENIM</strong></p>\n\n\t</div>\t\n\t\n<picture class=\"amp-dc-image\">\n\t\t\t<img loading=\"lazy\" src=\"//i1.adis.ws/i/dem/071219_NEW-SEASON_ZM_Shot_21_0879?upscale=false&strip=true\" class=\"amp-dc-image-pic\"/>\n\t\t</picture><div class=\"amp-dc-text\" >\n\t\t<p>This look is the epitome of jeans and a nice top! If you’ve got a dinner with the gals lined up this new year then this is the perfect look for you! Team your oversized shirt with an oversized clutch – so that you can fit ALL the things in it!  Split side jeans are the only denim you need right now, team with some lace up barely there’s and you’re good to go!</p>\n<p><strong><a href=\"https://www.boohoo.com/search?q=jeans\">Shop jeans</a></strong></p>\n\n\t</div>\t\n        </div>\n        <div class=\"amp-dc-block-wrap\"><!-- end old HBS -->\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- SFCC Slots -->\n\n\n\n\n\n\n\n<!-- External Slots -->\n\n<!-- Email Specific Templates-->\n\n\n</div>\n        <div class=\"amp-dc-block-wrap\"><!-- end old HBS -->\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- SFCC Slots -->\n\n\n\n\n\n\n\n<!-- External Slots -->\n\n<!-- Email Specific Templates-->\n\n\n</div>\n        <div class=\"amp-dc-block-wrap\"><!-- end old HBS -->\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- SFCC Slots -->\n\n\n\n\n\n\n\n<!-- External Slots -->\n\n<!-- Email Specific Templates-->\n\n\n</div>\n    </div>\n</div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<!-- SFCC Slots -->\n\n\n\n\n\n\n\n<!-- External Slots -->\n\n<!-- Email Specific Templates-->\n\n\n\n\n\n\n\n\n<!-- External Slots -->\n\n<!-- Email Specific Templates-->\n\n\n"}],"query":"oversized","refinements":[{"_type":"content_search_refinement","attribute_id":"fdid","label":"Folder","values":[{"_type":"content_search_refinement_value","hit_count":0,"label":"About Salesforce","value":"about-us"},{"_type":"content_search_refinement_value","hit_count":0,"label":"Customer Service","value":"customer-service"},{"_type":"content_search_refinement_value","hit_count":0,"label":"Search Banner","value":"SearchBanner"}]}],"selected_refinements":{"fdid":"blog"},"start":0,"total":1}

    var contents = document.querySelectorAll('[data-amp-sfcc-content-search]');
    contents.forEach(function (searchdom) {
      console.log('Found SFCC Content Search Container');
      // Get the configuration
      var query = searchdom.getAttribute('data-amp-content-search-query');
      var numItems = searchdom.getAttribute('data-amp-content-search-numItems');
      var folder = searchdom.getAttribute('data-amp-content-search-folder');

      var req =
        'https://zzfr-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArchGlobal/dw/shop/v20_4/content_search?';
      if (query) req += '&q=' + query;
      if (numItems) req += '&count=' + numItems;
      if (folder) req += '&refine=fdid=' + folder;

      $.ajax({
        url:
          req +
          '&client_id=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa',
        context: searchdom,
        success: function (data) {
          console.log(data);
          if (data && data.hits) {
            var htmlToAdd = '';
            data.hits.forEach(function (item) {
              console.log(item);

              var htmlSource = item.c_body;

              console.log( $(htmlSource).find('.amp-dc-snippet .amp-dc-image img') )



              var link =
                'https://zzfr-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArchGlobal/' +
                item.id +
                '.html?lang=default';
              var image = $(htmlSource).find('.amp-dc-snippet .amp-dc-image img').attr('src')
              var name = $(htmlSource).find('.amp-dc-snippet .amp-dc-snippet-overlay .o-dc-text-headline1').text()
              var price = $(htmlSource).find('.amp-dc-snippet .amp-dc-snippet-overlay .o-dc-text-copy').text()

              var html =
                '<div class="cell medium-6 large-3 o-dc-card2-slider-item" ><a class="o-dc-card card-bg  card2" href="' +
                link +
                '"><div class="amp-dc-card-wrap"><div class="o-dc-card-img"><picture class="amp-dc-image"><img loading="lazy" src="' +
                image +
                '?w=500" class="amp-dc-image-pic"/></picture></div><div class="o-dc-card-text"><h4 class="o-dc-card-title">' +
                name +
                '</h4><p class="o-dc-card-copy extra-padding-bottom">' +
                price +
                '</p><div class="cell large-shrink"><div class="o-dc-button small">Read Now</div></div></div></div></a></div>';
              htmlToAdd += html;
            });
            searchdom.innerHTML = htmlToAdd;
          }
        },
      });
    });



  }



  function initSFCCProducts() {

    // Get all individual product codes
    var products = document.querySelectorAll('[data-amp-sfcc-product-code]');
    products.forEach(function (item) {
      console.log('Found a product to load');
      var productCode = item.getAttribute('data-amp-sfcc-product-code');
        $.ajax({
            url: 'https://zzfr-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArchGlobal/dw/shop/v20_4/products/' + productCode + '?client_id=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&expand=prices,images,availability,variations',
            context: item,
            success: function(data) {
                var image = data.image_groups.find(x => x.view_type === 'large').images[0].link;
                var link = 'https://zzfr-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArchGlobal/amp-product-link/' + data.id + '.html';
                var name = data.name;
                var price = '&pound;' + data.price;
                
                var html =
                '<a class="o-dc-card card-bg  card2" href="' +
                link +
                '"><div class="amp-dc-card-wrap"><div class="o-dc-card-img"><picture class="amp-dc-image"><img loading="lazy" src="' +
                image +
                '?$product-list$" class="amp-dc-image-pic"/></picture></div><div class="o-dc-card-text"><h4 class="o-dc-card-title">' +
                name +
                '</h4><p class="o-dc-card-copy extra-padding-bottom">' +
                price +
                '</p><div class="cell large-shrink"><div class="o-dc-button small">Shop Now</div></div></div></div></a>';
                $(item).html(html);
            }
        })
    });




    // Get all maps
    var searches = document.querySelectorAll('[data-amp-sfcc-product-search]');
    searches.forEach(function (searchdom) {
      console.log('Found SFCC Product Search Container');
      // Get the configuration
      var query = searchdom.getAttribute('data-amp-product-search-query');
      var numItems = searchdom.getAttribute('data-amp-product-search-numItems');
      var category = searchdom.getAttribute('data-amp-product-search-category');
      var sortby = searchdom.getAttribute('data-amp-product-search-sortby'); 

      var req =
        'https://zzfr-002.sandbox.us01.dx.commercecloud.salesforce.com/s/RefArchGlobal/dw/shop/v20_4/product_search?';
      if (query) req += '&q=' + query;
      if (numItems) req += '&count=' + numItems;
      if (category) req += '&refine_1=cgid=' + category;
      if (sortby) req += '&sort=' + sortby;

      /**if( testSearch && testSearch.hits){
          var htmlToAdd = "";
        testSearch.hits.forEach(
            function(item){
                console.log(item)


                var link = 'https://amplience02-tech-prtnr-na03-dw.demandware.net/s/RefArchGlobal/amplience-product-link/' + item.product_id + '.html?lang=default'; //item.link;
                var image = item.image.link;
                var name = item.product_name;
                var price = '&pound;' + item.price;


                var html =
              '<div class="cell medium-6 large-3 o-dc-card2-slider-item" ><a class="o-dc-card card-bg  card2" href="' +
              link +
              '"><div class="amp-dc-card-wrap"><div class="o-dc-card-img"><picture class="amp-dc-image"><img loading="lazy" src="' +
              image +
              '?$product-list$" class="amp-dc-image-pic"/></picture></div><div class="o-dc-card-text"><h4 class="o-dc-card-title">' +
              name +
              '</h4><p class="o-dc-card-copy extra-padding-bottom">'+
              price +'</p><div class="cell large-shrink"><div class="o-dc-button small">Shop Now</div></div></div></div></a></div>';
              htmlToAdd += html;
            }
        )
        searchdom.innerHTML = htmlToAdd
      }*/

      $.ajax({
        url:
          req +
          '&client_id=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&expand=prices,images,availability,variations',
        context: searchdom,
        success: function (data) {
          console.log(data);
          if (data && data.hits) {
            var htmlToAdd = '';
            data.hits.forEach(function (item) {
              console.log(item);

              var link =
                'https://amplience02-tech-prtnr-na03-dw.demandware.net/s/RefArchGlobal/amplience-product-link/' +
                item.product_id +
                '.html?lang=default';
              var image = item.image.link;
              var name = item.product_name;
              var price = '&pound;' + item.price;

              var html =
                '<div class="cell medium-6 large-3 o-dc-card2-slider-item" ><a class="o-dc-card card-bg  card2" href="' +
                link +
                '"><div class="amp-dc-card-wrap"><div class="o-dc-card-img"><picture class="amp-dc-image"><img loading="lazy" src="' +
                image +
                '?$product-list$" class="amp-dc-image-pic"/></picture></div><div class="o-dc-card-text"><h4 class="o-dc-card-title">' +
                name +
                '</h4><p class="o-dc-card-copy extra-padding-bottom">' +
                price +
                '</p><div class="cell large-shrink"><div class="o-dc-button small">Shop Now</div></div></div></div></a></div>';
              htmlToAdd += html;
            });
            searchdom.innerHTML = htmlToAdd;
          }
        },
      });
    });
  }

  exports.Utils = window.AmpCa.Utils || exports.Utils || {};
  exports.Utils.initSFCCProducts = initSFCCProducts;
  exports.Utils.initSFCCContentSearch = initSFCCContentSearch;

  window.addEventListener('load', function () {
    console.log('SFCC Load triggered');
    initSFCCProducts();
    initSFCCContentSearch();
  });
})((window.AmpCa = window.AmpCa || {}));
